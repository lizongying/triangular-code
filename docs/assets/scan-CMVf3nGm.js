import"./modulepreload-polyfill-DQ8RlzRK.js";window.onload=()=>{let e=document.getElementById(`webcam`),t=document.getElementById(`result`),n=document.getElementById(`canvas`),r=document.getElementById(`canvasContainer`),i=n.getContext(`2d`,{willReadFrequently:!0}),a=0,o=0,s=null,c=()=>{let e=r.clientWidth*window.devicePixelRatio,t=r.clientHeight*window.devicePixelRatio;n.width=e,n.height=t},l=()=>{let t=n.width,r=n.height,i=e.videoWidth/e.videoHeight,a=t/r,o=0,s=0,c=0,l=0;return i>a?(l=r,c=r*i,o=(t-c)/2):(c=t,l=t/i,s=(r-l)/2),{x:o,y:s,w:c,h:l}},u=()=>{let e=new window.AudioContext,t=e.createOscillator(),n=e.createGain();t.connect(n),n.connect(e.destination),t.frequency.setValueAtTime(1200,e.currentTime),n.gain.setValueAtTime(.1,e.currentTime),t.start(),t.stop(e.currentTime+.2)},d=()=>{s=new Worker(new URL(`/tricode/assets/detector.worker-qvTNbNa1.js`,``+import.meta.url),{type:`module`}),s.onmessage=e=>{let n=e.data;n.success&&(t.textContent=n.text,u())},s.onerror=e=>{console.error(e),h()}};async function f(){try{d(),e.srcObject=await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:`environment`},width:{ideal:1080},height:{ideal:1920}}}),e.onloadedmetadata=async()=>{await e.play(),c(),p()}}catch(e){console.error(e),h()}}let p=()=>{if(e.paused)return;i.clearRect(0,0,n.width,n.height);let t=l();i.drawImage(e,0,0,e.videoWidth,e.videoHeight,t.x,t.y,t.w,t.h);let r=Math.min(n.width,n.height)*.9,c=r*(Math.sqrt(3)/2),u=(n.width-r)/2,d=(n.height+c)/2,f=(n.width+r)/2,m=d,h=n.width/2,g=(n.height-c)/2;if(i.strokeStyle=`#ffffff`,i.lineWidth=1,i.beginPath(),i.moveTo(u,d),i.lineTo(f,m),i.lineTo(h,g),i.closePath(),i.stroke(),o++,o>=60){o=0;let e=Math.floor(r),t=Math.floor(c),n=i.getImageData(u,g,e,t);s&&s.postMessage({imageData:n.data,width:e,height:t},[n.data.buffer])}a=requestAnimationFrame(p)};window.addEventListener(`resize`,c),f().then();let m=()=>{cancelAnimationFrame(a);let t=e.srcObject;t&&(t.getTracks().forEach(e=>e.stop()),e.srcObject=null)},h=()=>{s&&=(s.terminate(),null)};window.addEventListener(`beforeunload`,()=>{m(),h()})};