import"./modulepreload-polyfill-DQ8RlzRK.js";window.onload=()=>{let e=document.getElementById(`webcam`),t=document.getElementById(`result`),n=document.getElementById(`canvas`),r=document.getElementById(`canvasContainer`),i=n.getContext(`2d`,{willReadFrequently:!0}),a=0,o=0,s=null,c=()=>{let e=r.clientWidth*window.devicePixelRatio,t=r.clientHeight*window.devicePixelRatio;n.width=e,n.height=t},l=()=>{let t=n.width,r=n.height,i=e.videoWidth/e.videoHeight,a=t/r,o=0,s=0,c=0,l=0;return i>a?(l=r,c=r*i,o=(t-c)/2):(c=t,l=t/i,s=(r-l)/2),{x:o,y:s,w:c,h:l}},u=()=>{s=new Worker(new URL(`/tricode/assets/detector.worker-BmK3L1ZH.js`,``+import.meta.url),{type:`module`}),s.onmessage=e=>{let n=e.data;n.success&&(t.textContent=n.text)},s.onerror=e=>{console.error(e),m()}};async function d(){try{u(),e.srcObject=await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:`environment`},width:{ideal:1080},height:{ideal:1920}}}),e.onloadedmetadata=async()=>{await e.play(),c(),f()}}catch(e){console.error(e),m()}}let f=()=>{if(e.paused)return;i.clearRect(0,0,n.width,n.height);let t=l();i.drawImage(e,0,0,e.videoWidth,e.videoHeight,t.x,t.y,t.w,t.h);let r=Math.min(n.width,n.height)*.9,c=r*(Math.sqrt(3)/2),u=(n.width-r)/2,d=(n.height+c)/2,p=(n.width+r)/2,m=d,h=n.width/2,g=(n.height-c)/2;if(i.strokeStyle=`#ffffff`,i.lineWidth=1,i.beginPath(),i.moveTo(u,d),i.lineTo(p,m),i.lineTo(h,g),i.closePath(),i.stroke(),o++,o>=300){o=0;let e=Math.floor(r),t=Math.floor(c),n=i.getImageData(u,g,e,t);s&&s.postMessage({imageData:n.data,width:e,height:t},[n.data.buffer])}a=requestAnimationFrame(f)};window.addEventListener(`resize`,c),d().then();let p=()=>{cancelAnimationFrame(a);let t=e.srcObject;t&&(t.getTracks().forEach(e=>e.stop()),e.srcObject=null)},m=()=>{s&&=(s.terminate(),null)};window.addEventListener(`beforeunload`,()=>{p(),m()})};